{% extends "base.html" %}
{% block title %}History â€” AI Content Engine{% endblock %}
{% block page_title %}Published History{% endblock %}

{% block content %}
{% if pipelines %}
<div class="pipeline-list">
    {% for p in pipelines %}
    <div class="pipeline-card">
        <div class="pipeline-header">
            <span class="pipeline-date">{{ p.created_at.strftime('%b %d, %Y at %H:%M') }}</span>
            <span class="badge badge-published">published</span>
        </div>

        {% if p.editor_output %}
        <h3>{{ p.editor_output.medium_draft.title }}</h3>
        <p class="preview-text">{{ p.editor_output.linkedin_draft.content[:180] }}...</p>
        {% endif %}

        <div class="publish-results">
            {% if p.linkedin_result %}
            <span class="result {% if p.linkedin_result.success %}result-success{% else %}result-fail{% endif %}">
                {% if p.linkedin_result.success %}&#10003;{% else %}&#10007;{% endif %}
                LinkedIn
                {% if p.linkedin_result.post_url %}
                &middot; <a href="{{ p.linkedin_result.post_url }}" target="_blank" rel="noopener">View</a>
                {% endif %}
            </span>
            {% endif %}

            {% if p.medium_result %}
            <span class="result {% if p.medium_result.success %}result-success{% else %}result-fail{% endif %}">
                {% if p.medium_result.success %}&#10003;{% else %}&#10007;{% endif %}
                Medium
                {% if p.medium_result.post_url %}
                &middot; <a href="{{ p.medium_result.post_url }}" target="_blank" rel="noopener">View</a>
                {% endif %}
            </span>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <div class="empty-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
    </div>
    <h3>No published posts yet</h3>
    <p>Approve and publish drafts to see them here.</p>
    <a href="/" class="btn btn-primary">View Drafts</a>
</div>
{% endif %}
{% endblock %}
